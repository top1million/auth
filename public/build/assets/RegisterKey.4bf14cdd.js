import{r as c,l as w,E as i,j as k,i as x,d as K,b as t,s as _,v as b,a as d,H as S,w as y,n as M,k as C,o as B,f as h}from"./app.68da1afe.js";import{_ as I}from"./Label.24c07f87.js";import{_ as N}from"./Input.0751bc64.js";import{_ as $}from"./InputError.b8b84cca.js";import{_ as V}from"./SecondaryButton.af35b469.js";import{_ as j}from"./Button.64ca3b3a.js";import E from"./WaitForKey.9cd4c192.js";const R=["onSubmit"],T={class:"mt-4"},q={class:"mt-4"},z={class:"mt-5 flex items-center"},J={__name:"RegisterKey",props:{errorMessage:String,name:String,form:Object},emits:["start","stop","register","update:name"],setup(a,{emit:l}){const o=a,r=c(!1),n=c(o.errorMessage),v=c(null);w(()=>{o.form.reset(),i().then(()=>v.value.focus())}),k(()=>o.errorMessage,e=>{n.value=e});const u=x(()=>r.value===!0||o.form.processing),f=()=>{r.value=!0,n.value="",i().then(()=>l("start")),axios.post(route("webauthn.store.options")).then(e=>{e.data!==void 0?p(e.data.publicKey):i().then(()=>p(e.props.publicKey))}).catch(e=>{g(),n.value=e.response.data.errors[0]})},p=e=>{r.value===!0&&l("register",e)},g=()=>{r.value=!1,i().then(()=>l("stop"))};return(e,s)=>(B(),K("form",{onSubmit:C(f,["prevent"])},[t($,{message:a.form.errors.register,class:"mt-2"},null,8,["message"]),_(d("div",T,[t(I,{for:"name",value:"Key name"}),t(N,{type:"text",class:"mt-1 block w-3/4",id:"name",ref_key:"nameInput",ref:v,value:a.name,onInput:s[0]||(s[0]=m=>e.$emit("update:name",m.target.value)),required:"",onKeyup:s[1]||(s[1]=S(m=>f(),["enter"]))},null,8,["value"]),t($,{message:a.form.errors.name,class:"mt-2"},null,8,["message"])],512),[[b,!u.value||a.form.errors.name]]),_(d("div",q,[t(E,{"error-message":n.value,form:a.form,onRetry:s[2]||(s[2]=m=>f())},null,8,["error-message","form"])],512),[[b,r.value]]),d("div",z,[t(V,{onClick:s[3]||(s[3]=m=>g())},{default:y(()=>[h(" Cancel ")]),_:1}),t(j,{class:M(["ms-2",{"opacity-25":u.value}]),disabled:u.value},{default:y(()=>[h(" Submit ")]),_:1},8,["class","disabled"])])],40,R))}};export{J as default};
